Or ye rha code #include <AFMotor.h>
#include <Servo.h>

// --- Component Setup ---
// Motors
AF_DCMotor motor1(1);
AF_DCMotor motor2(2);
AF_DCMotor motor3(3);
AF_DCMotor motor4(4);

// Servo
Servo headServo;

// IR Sensors (Analog Pins)
const int irLeftPin = A0;
const int irCenterPin = A1;
const int irRightPin = A2;

// Ultrasonic Sensor
const int trigPin = A3;
const int echoPin = A4;

// Variables
int leftVal, centerVal, rightVal;
int stopDist = 15; // Distance in cm to stop

void setup() {
  Serial.begin(9600);
  
  // Attach Servo to Pin 10 (standard for Servo_1 on shield)
  headServo.attach(10); 
  headServo.write(90); // Look forward

  // Setup Ultrasonic pins
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);

  // Set motor speed (0-255)
  motor1.setSpeed(150);
  motor2.setSpeed(150);
  motor3.setSpeed(150);
  motor4.setSpeed(150);
}

void loop() {
  // 1. Check for Obstacles first (Safety)
  int distance = readDistance();
  
  if (distance < stopDist && distance > 0) {
    stopBot();
    delay(500);
    moveBackward();
    delay(500);
    stopBot();
    // Use servo to look around logic could go here
  } 
  else {
    // 2. No obstacle? Follow the Light!
    trackLight();
  }
  
  delay(50); // Small stability delay
}

void trackLight() {
  leftVal = analogRead(irLeftPin);
  centerVal = analogRead(irCenterPin);
  rightVal = analogRead(irRightPin);

  // Debugging - view these in Serial Monitor to calibrate
  // Serial.print("L:"); Serial.print(leftVal);
  // Serial.print(" C:"); Serial.print(centerVal);
  // Serial.print(" R:"); Serial.println(rightVal);
  
  // Threshold to move (ignore if it's too dark)
  if (leftVal < 100 && centerVal < 100 && rightVal < 100) {
    stopBot();
    return;
  }

  if (centerVal >= leftVal && centerVal >= rightVal) {
    moveForward();
  } 
  else if (leftVal > centerVal && leftVal > rightVal) {
    turnLeft();
  } 
  else if (rightVal > centerVal && rightVal > leftVal) {
    turnRight();
  }
}

// --- Movement Functions ---

void moveForward() {
  motor1.run(FORWARD); motor2.run(FORWARD);
  motor3.run(FORWARD); motor4.run(FORWARD);
}

void moveBackward() {
  motor1.run(BACKWARD); motor2.run(BACKWARD);
  motor3.run(BACKWARD); motor4.run(BACKWARD);
}

void turnLeft() {
  motor1.run(BACKWARD); motor2.run(BACKWARD); // Left side back
  motor3.run(FORWARD); motor4.run(FORWARD);   // Right side fwd
}

void turnRight() {
  motor1.run(FORWARD); motor2.run(FORWARD);   // Left side fwd
  motor3.run(BACKWARD); motor4.run(BACKWARD); // Right side back
}

void stopBot() {
  motor1.run(RELEASE); motor2.run(RELEASE);
  motor3.run(RELEASE); motor4.run(RELEASE);
}

// --- Ultrasonic Function ---
int readDistance() {
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);
  
  long duration = pulseIn(echoPin, HIGH);
  return duration * 0.034 / 2;
}
